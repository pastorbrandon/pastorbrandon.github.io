<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gear Details Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .gear-slot {
            border: 1px solid #444;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            background: #333;
        }
        .gear-name {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .add-gear-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }
        .add-gear-btn:hover {
            background: #0056b3;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
        }
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
        }
        .close {
            float: right;
            font-size: 24px;
            cursor: pointer;
            background: none;
            border: none;
            color: #fff;
        }
    </style>
</head>
<body>
    <h1>Gear Details Test</h1>
    
    <div class="test-section">
        <h2>Test Instructions</h2>
        <p>This test demonstrates the gear details functionality:</p>
        <ol>
            <li>When no gear is equipped, clicking the button should show "Add Gear" behavior</li>
            <li>When gear is equipped, clicking the button should show "View Details" modal</li>
            <li>The modal should not appear on page load</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>Gear Slot Test</h2>
        <div class="gear-slot" data-slot="test-slot">
            <div class="gear-name" data-grade="unscored">No gear equipped</div>
            <button class="add-gear-btn">+ Add Gear</button>
        </div>
    </div>

    <!-- Gear Details Modal -->
    <div id="detailsModal" class="modal" aria-hidden="true">
        <div class="modal-content">
            <button id="detailsClose" class="close" aria-label="Close">Ã—</button>
            <h3 id="detailsTitle">Item</h3>
            <div id="detailsBody"></div>
        </div>
    </div>

    <script>
        // Simulate the gear data structure
        let build = {};
        
        // Test functions
        function updateGearDisplay(slot, gearData) {
            const slotElement = document.querySelector(`[data-slot="${slot}"]`);
            if (!slotElement) return;

            const nameElement = slotElement.querySelector('.gear-name');
            const addButton = slotElement.querySelector('.add-gear-btn');

            if (gearData.name && gearData.name !== 'No gear equipped') {
                nameElement.textContent = gearData.name;
                nameElement.setAttribute('data-grade', gearData.grade ? gearData.grade.toLowerCase() : 'unscored');
                addButton.textContent = 'View Details';
                addButton.onclick = () => showGearModal(slot);
            } else {
                nameElement.textContent = 'No gear equipped';
                nameElement.setAttribute('data-grade', 'unscored');
                addButton.textContent = '+ Add Gear';
                addButton.onclick = () => addTestGear(slot);
            }
        }

        function showGearModal(slot) {
            const gearData = build[slot];
            if (!gearData) return;

            const detailsTitle = document.getElementById('detailsTitle');
            const detailsBody = document.getElementById('detailsBody');

            detailsTitle.textContent = gearData.name;
            
            const grade = gearData.grade || 'Unknown';
            const affixes = gearData.affixes || [];
            const aspect = gearData.aspect || 'None';
            const score = gearData.score || 'N/A';
            
            let detailsHTML = `
                <div class="gear-details-content">
                    <div class="gear-grade ${grade.toLowerCase()}">
                        <strong>Grade:</strong> ${grade}
                    </div>
                    
                    <div class="gear-score">
                        <strong>Score:</strong> ${score}
                    </div>
                    
                    <div class="gear-slot">
                        <strong>Slot:</strong> ${slot.charAt(0).toUpperCase() + slot.slice(1)}
                    </div>
                    
                    <div class="gear-affixes">
                        <strong>Affixes:</strong>
                        <ul>
                            ${affixes.map(affix => `<li>${affix}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div class="gear-aspect">
                        <strong>Aspect:</strong> ${aspect}
                    </div>
                </div>
            `;
            
            detailsBody.innerHTML = detailsHTML;
            document.getElementById('detailsModal').classList.add('show');
        }

        function addTestGear(slot) {
            // Simulate adding gear
            build[slot] = {
                name: 'Test Legendary Item',
                slot: slot,
                grade: 'A',
                affixes: ['Critical Strike Chance', 'Attack Speed', 'Damage to Elites'],
                aspect: 'Test Aspect',
                score: 85
            };
            
            updateGearDisplay(slot, build[slot]);
        }

        function removeTestGear(slot) {
            build[slot] = { name: 'No gear equipped' };
            updateGearDisplay(slot, build[slot]);
        }

        // Initialize modal functionality
        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('detailsModal');
            const closeBtn = document.getElementById('detailsClose');

            // Close modal
            function closeModal() {
                modal.classList.remove('show');
            }

            closeBtn.addEventListener('click', closeModal);
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });

            // Initialize gear display
            updateGearDisplay('test-slot', { name: 'No gear equipped' });
        });

        // Add test controls
        document.addEventListener('DOMContentLoaded', () => {
            const testSection = document.querySelector('.test-section:nth-child(2)');
            const controls = document.createElement('div');
            controls.innerHTML = `
                <h3>Test Controls</h3>
                <button onclick="addTestGear('test-slot')">Add Test Gear</button>
                <button onclick="removeTestGear('test-slot')">Remove Test Gear</button>
            `;
            testSection.appendChild(controls);
        });
    </script>
</body>
</html>
